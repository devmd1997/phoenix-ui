"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const d=require("../BaseButton/BaseButton.cjs.js"),r=require("./BaseExpandListRow.cjs.js");require("./BaseExpandList.vue_vue_type_style_index_0_scoped_27bf38da_lang.cjs.js");const o=require("../../_virtual/_plugin-vue2_normalizer.cjs.js");function l(e){if(e&&e.__esModule)return e;const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const a in e)if(a!=="default"){const s=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,s.get?s:{enumerable:!0,get:()=>e[a]})}}return t.default=e,Object.freeze(t)}const u={name:"BaseExpandList",components:{BaseButton:d.default,BaseExpandListRow:r.default,Draggable:()=>Promise.resolve().then(()=>l(require("vuedraggable"))).then(e=>e.default||e)},props:{data:{type:Array,default:()=>[]},edit:{type:Boolean,default:!1},minItems:{type:Number,default:3},multiple:{type:Boolean,default:!1},showMoreText:{type:String,default:"Show all"},showLessText:{type:String,default:"Show less"},editHideText:{type:String,default:"Hide"},editShowText:{type:String,default:"Show"},supportiveText:{type:Object,default:()=>({activate:"Use the Enter key to select item. Item is currently {state}",activated:"Item selected. Use arrow keys to order item.",description:"Use Tab key to navigate to item an order item.",moved:"Item moved: {pos} of {total}",visible:"visible",hidden:"hidden"}),validator:e=>Object.keys(e).every(t=>["activate","activated","description","moved","visible","hidden"].includes(t))},controlType:{type:String,default:"button",validator:e=>["button","toggle"].includes(e)},expanded:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1}},data(){return{assertiveText:"",showAll:!1,dataSorted:null,originalData:null,dragHandle:""}},computed:{dataInt:{get(){return this.dataSorted||this.data},set(e){this.dataSorted=e}}},watch:{dataSorted:{handler(e){this.edit&&JSON.stringify(e)!==JSON.stringify(this.data)&&this.$emit("update:data",e)},deep:!0},data:{handler(e){JSON.stringify(e)!==JSON.stringify(this.dataSorted)&&(this.dataInt=JSON.parse(JSON.stringify(e)))},deep:!0,immediate:!0},edit(e){this.assertiveText="",e&&(this.$nextTick(()=>{this.$refs.baseExpandListDraggable.focus({preventScroll:!0})}),this.originalData=JSON.parse(JSON.stringify(this.data)))},expanded(e){this.expandItems(e)}},mounted(){this.dragHandle=this.isTouchCapable()?[".base-expand-item__handle"]:[".base-expand-item__handle",".base-expand-item__label"]},methods:{expandItems(e){!e.length||(e[0]>=this.minItems&&this.$refs.baseExpandListRow[e[0]]&&(this.showAll=!0),e[0]!==void 0&&this.$refs.baseExpandListRow[e[0]]&&(this.$refs.baseExpandListRow[e[0]].expanded=!0),e[1]!==void 0&&this.$refs.baseExpandListRow[e[0]].$refs.baseExpandListRow[e[1]]&&(this.$refs.baseExpandListRow[e[0]].$refs.baseExpandListRow[e[1]].expanded=!0))},emitExpandedState(e){this.$emit("expanded-state",e)},updateData(e,t){this.$set(this.dataSorted,t,e)},sort({direction:e},t){if(e==="up"&&t-1<0||e==="down"&&t+1>=this.dataInt.length){this.$refs.baseExpandListRow[t].useSupportiveText=!1,this.$refs.baseExpandListRow[t].movable=!0;return}const a=e==="up"?t-1:t+1,s=t,i=this.dataInt;i.splice(a,0,i.splice(s,1)[0]),this.dataInt=i,this.assertiveText=this.supportiveText.moved.replace("{pos}",a+1).replace("{total}",this.dataInt.length),this.$refs.baseExpandListRow[a].useSupportiveText=!1,this.$refs.baseExpandListRow[a].movable=!0},reset(){this.dataInt=JSON.parse(JSON.stringify(this.originalData)),this.$emit("update:data",this.dataInt)},save(){this.$emit("saved",this.dataInt),this.originalData=JSON.parse(JSON.stringify(this.dataInt))},supportive(e,t){const a=this.dataInt[t].hidden?this.supportiveText.hidden:this.supportiveText.visible,s=this.supportiveText[e].replace("{state}",a);if(this.assertiveText===s){this.assertiveText="",setTimeout(()=>{this.assertiveText=s},1);return}this.assertiveText=s},isTouchCapable(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch||navigator.maxTouchPoints>0||window.navigator.msMaxTouchPoints>0}}};var p=function(){var t=this,a=t._self._c;return a("div",{staticClass:"base-expand-list"},[a("div",{class:["base-box-shadow",{"base-box-shadow--edit":t.edit}]},[t.edit?t._e():a("ul",t._l(t.data,function(s,i){return a("BaseExpandListRow",{directives:[{name:"show",rawName:"v-show",value:i<(t.showAll?t.data.length:t.minItems),expression:"index < (showAll ? data.length : minItems)"}],key:i,ref:"baseExpandListRow",refInFor:!0,attrs:{"parent-index":i,data:s,multiple:t.multiple,"render-as":"li"},on:{"expanded-state":t.emitExpandedState},scopedSlots:t._u([{key:"content",fn:function(n){return[t._t("content",null,{data:n.data})]}}],null,!0)})}),1),t.edit?[a("div",{staticClass:"supportive-text",attrs:{"aria-live":"assertive"}},[t._v(" "+t._s(t.assertiveText)+" ")]),a("p",{staticClass:"supportive-text",attrs:{id:`draggable-${t._uid}`}},[t._v(" "+t._s(t.supportiveText.description)+" ")]),a("div",{ref:"baseExpandListDraggable",staticClass:"base-expand-list__draggable",attrs:{tabindex:"0","aria-labelledby":`draggable-${t._uid}`}},[a("draggable",{staticClass:"base-expand-list__draggable",attrs:{draggable:".base-expand-list__draggable__item",handle:t.dragHandle,disabled:t.disabled,animation:"150"},model:{value:t.dataInt,callback:function(s){t.dataInt=s},expression:"dataInt"}},t._l(t.dataInt,function(s,i){return a("BaseExpandListRow",{key:i,ref:"baseExpandListRow",refInFor:!0,staticClass:"base-expand-list__draggable__item",attrs:{data:s,edit:!0,"edit-hide-text":t.editHideText,"edit-show-text":t.editShowText,"control-type":t.controlType,disabled:t.disabled},on:{supportive:function(n){return t.supportive(n,i)},sorted:function(n){return t.sort(n,i)},"update:data":function(n){return t.updateData(n,i)}}})}),1)],1)]:t._e()],2),!t.edit&&t.data.length>t.minItems?a("BaseButton",{class:{"base-button-icon-rotate-180":t.showAll},attrs:{id:`base-expand-list-${t._uid}`,"aria-expanded":t.showAll?"true":"false","has-background-color":!1,icon:"drop-down","icon-position":"right",text:t.showAll?t.showLessText:t.showMoreText},on:{clicked:function(s){t.showAll=!t.showAll}}}):t._e()],1)},h=[],c=o.default(u,p,h,!1,null,"27bf38da",null,null);const f=c.exports;exports.default=f;
//# sourceMappingURL=BaseExpandList.cjs.js.map
