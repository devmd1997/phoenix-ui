"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const s=require("../BaseIcon/BaseIcon.cjs.js"),o=require("../BaseChipsInputField/BaseChipsInputField.cjs.js"),l=require("../../mixins/i18n.cjs.js"),r=require("../../mixins/navigateList.cjs.js");require("./BaseChipsInput.vue_vue_type_style_index_0_scoped_90d3c286_lang.cjs.js");const a=require("../../_virtual/_plugin-vue2_normalizer.cjs.js"),p={name:"BaseChipsInput",components:{BaseIcon:s.default,BaseDropDownList:()=>Promise.resolve().then(()=>require("../BaseDropDownList/BaseDropDownList.cjs.js")).then(t=>t.default||t),BaseChipsInputField:o.default},mixins:[l.default,r.default],model:{prop:"selectedList",event:"selected-changed"},props:{list:{type:Array,default:()=>[]},selectedList:{type:Array,default:()=>[]},label:{type:String,required:!0},showLabel:{type:Boolean,default:!0},placeholder:{type:String,default:null},dropDownNoOptionsInfo:{type:String,default:"No options available"},allowUnknownEntries:{type:Boolean,default:!1},allowMultipleEntries:{type:Boolean,default:!0},allowDynamicDropDownEntries:{type:Boolean,default:!1},addSelectedEntryDirectly:{type:Boolean,default:!0},showInputBorder:{type:Boolean,default:!0},sortable:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},alwaysLinked:{type:Boolean,default:!1},hoverboxContent:{type:Object,default:()=>({})},isLoading:{type:Boolean,default:!1},sortText:{type:String,default:"Sort A \u2013 Z"},sortName:{type:Boolean,default:!1},language:{type:String,default:""},addNewChipText:{type:String,default:""},id:{type:String,default:""},identifierPropertyName:{type:String,default:""},labelPropertyName:{type:String,default:""},displayChipsInline:{type:Boolean,default:!0},required:{type:Boolean,default:!1},invalid:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},errorMessage:{type:String,default:""},showErrorIcon:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},inputClass:{type:String,default:""},chipsEditable:{type:Boolean,default:!1},assistiveText:{type:Object,default:()=>({})}},data(){return{input:"",selectedListInt:[],activeOptionIndex:0,selectedOption:null,isActive:!1,dropDownActive:!1,returnAsString:!1,dropDownMinWidth:"100%",inputElem:null}},computed:{chipsFieldInputProps(){const t={...this.$props};return delete t.dropDownNoOptionsInfo,delete t.allowDynamicDropDownEntries,delete t.addNewChipText,delete t.list,t},listInt(){let t=[];return this.list&&this.list.length&&typeof this.list[0]=="string"?t=this.list.map(e=>({[this.labelPropertyName]:e})):t=[...this.list],this.allowUnknownEntries&&this.input&&t.unshift({[this.labelPropertyName]:this.language?{[this.language]:this.input}:this.input}),this.selectedListInt&&this.selectedListInt.length&&(t=t.filter(e=>!this.selectedListInt.map(n=>n[this.identifierPropertyName]||n[this.labelPropertyName]).includes(e[this.identifierPropertyName]||e[this.labelPropertyName]))),this.input&&!this.allowDynamicDropDownEntries?t.filter(e=>this.getLangLabel(e[this.labelPropertyName]).toLowerCase().includes(this.input.toLowerCase())):t},chipsInputActive:{set(t){this.dropDownActive=t,this.isActive=t},get(){return this.isActive||this.dropDownActive}},activeOption:{set(t){this.activeOptionIndex=this.listInt.indexOf(t)},get(){return this.listInt[this.activeOptionIndex]}}},watch:{selectedOption(t){t&&(this.addSelectedOption(t),this.inputElem&&this.allowMultipleEntries&&this.inputElem.focus())},listInt:{handler(t){t.length&&!this.activeOption?this.activeOptionIndex=0:!t.length&&(!this.allowUnknownEntries||!this.input)&&(this.activeOptionIndex=-1)},immediate:!0},list:{handler(t){this.activeOptionIndex=t.length||this.allowUnknownEntries&&this.input?0:-1,!this.returnAsString&&t&&t.length&&typeof t[0]=="string"&&(this.returnAsString=!0)},immediate:!0},selectedList:{handler(t){this.selectedListInt=[...t]},immediate:!0},selectedListInt(t){JSON.stringify(t)!==JSON.stringify(this.selectedList)&&this.updateParentSelectedList(t)},input(t){this.allowDynamicDropDownEntries&&this.$emit("fetch-dropdown-entries",{value:t,type:this.labelPropertyName})},chipsInputActive(t){t&&!this.allowDynamicDropDownEntries&&!this.listInt.length&&this.$emit("fetch-dropdown-entries",{value:this.input,type:this.labelPropertyName}),t&&(this.calcDropDownMinWidth(),this.activeOptionIndex=0)}},mounted(){const t=this.$el.getElementsByTagName("input");t&&t.length&&([this.inputElem]=t)},methods:{addSelectedOption(t){this.allowMultipleEntries?this.selectedListInt.push(t):(this.$set(this.selectedListInt,0,t),this.dropDownActive=!1),this.updateParentSelectedList(this.selectedListInt),this.input="",this.selectedOption=null,this.allowMultipleEntries||(this.chipsInputActive=!1,this.inputElem.blur())},updateParentSelectedList(t){if(JSON.stringify(this.selectedList)!==JSON.stringify(t)){let e=[...t];this.returnAsString&&(e=e.map(n=>n[this.labelPropertyName])),this.$emit("selected-changed",e)}},onInputFocus(){this.chipsInputActive=!0},onInputBlur(){this.chipsInputActive=!1,!this.dropDownActive&&document.activeElement.tagName==="BODY"&&(this.input="")},checkKeyEvent(t){t.key==="Tab"&&(this.chipsInputActive=!1)},onEnter(){this.activeOption&&this.addSelectedOption(this.activeOption)},onArrowKey(t){this.listInt.length&&(this.activeOption=this.navigate(this.listInt,t.key==="ArrowDown",this.activeOptionIndex,!0))},hoverBoxActive(t,e){this.$emit("hoverbox-active",{value:t,entry:e})},calcDropDownMinWidth(){const t=this.$refs.baseInput;t&&t.$el&&t.$el.clientWidth&&(this.dropDownMinWidth=`${t.$el.clientWidth}px`)}}};var u=function(){var e=this,n=e._self._c;return n("div",{staticClass:"base-chips-input"},[n("BaseChipsInputField",e._g(e._b({ref:"baseInput",attrs:{"add-selected-entry-directly":!1,"selected-list":e.selectedListInt,"drop-down-list-id":e.id,"linked-list-option":e.activeOption?e.activeOption[e.identifierPropertyName]:null,"return-as-string":e.returnAsString,"is-active":e.isActive,loadable:e.allowDynamicDropDownEntries},on:{"update:selectedList":function(i){e.selectedListInt=i},"update:selected-list":function(i){e.selectedListInt=i},"update:isActive":function(i){e.isActive=i},"update:is-active":function(i){e.isActive=i},keydown:[function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter")?null:(i.preventDefault(),e.onEnter.apply(null,arguments))},function(i){return!i.type.indexOf("key")&&e._k(i.keyCode,"up",38,i.key,["Up","ArrowUp"])&&e._k(i.keyCode,"down",40,i.key,["Down","ArrowDown"])?null:(i.preventDefault(),e.onArrowKey.apply(null,arguments))}],"click-input-field":e.onInputFocus,"clicked-outside":e.onInputBlur},scopedSlots:e._u([{key:"below-input",fn:function(){return[e.isActive?n("BaseDropDownList",{ref:"dropDownList",staticClass:"base-chips-input__drop-down",style:{"min-width":e.dropDownMinWidth},attrs:{"drop-down-options":e.listInt,"active-option":e.activeOption,"selected-option":e.selectedOption,"identifier-property-name":e.identifierPropertyName,"label-property-name":e.labelPropertyName,"list-id":e.id,language:e.language,"drop-down-no-options-info":e.dropDownNoOptionsInfo},on:{"update:activeOption":function(i){e.activeOption=i},"update:active-option":function(i){e.activeOption=i},"update:selectedOption":function(i){e.selectedOption=i},"update:selected-option":function(i){e.selectedOption=i},"within-drop-down":function(i){e.dropDownActive=i}},nativeOn:{click:function(i){i.stopPropagation()},touchstart:function(i){i.stopPropagation()}},scopedSlots:e._u([{key:"option",fn:function(i){return[e.allowUnknownEntries&&!i.option[e.identifierPropertyName]?n("span",{key:i.option[e.identifierPropertyName],ref:"option"},[e._v(" "+e._s(e.addNewChipText?`${e.addNewChipText} ${e.getLangLabel(i.option[e.labelPropertyName],!0)} ...`:`${e.getI18nTerm("form.Add",-1,{value:e.getLangLabel(i.option[e.labelPropertyName],!0)})} ...`)+" ")]):i?[e._t("drop-down-entry",function(){return[e._v(" "+e._s(e.getLangLabel(i.option[e.labelPropertyName],!0))+" ")]},{item:i.option})]:e._e()]}},{key:"no-options",fn:function(){return[e._t("no-options")]},proxy:!0}],null,!0)}):e._e()]},proxy:!0},{key:"label-addition",fn:function(){return[e._t("label-addition")]},proxy:!0},{key:"pre-input-field",fn:function(){return[e._t("pre-input-field")]},proxy:!0},{key:"input-field-addition-before",fn:function(){return[e._t("input-field-addition-before")]},proxy:!0},{key:"input-field-inline-before",fn:function(){return[e._t("input-field-inline-before")]},proxy:!0},{key:"input-field-addition-after",fn:function(){return[e._t("input-field-addition-after")]},proxy:!0},{key:"post-input-field",fn:function(){return[e._t("post-input-field"),e.allowMultipleEntries?e._e():n("div",{staticClass:"base-chips-input__single-dropdown",on:{keydown:function(i){if(!i.type.indexOf("key")&&e._k(i.keyCode,"enter",13,i.key,"Enter"))return null;i.stopPropagation(),e.isActive=!e.isActive},click:function(i){i.stopPropagation(),e.isActive=!e.isActive}}},[n("BaseIcon",{class:["base-chips-input__single-dropdown-icon",{"base-chips-input__single-dropdown-icon-rotated":e.isActive}],attrs:{name:"drop-down"}})],1)]},proxy:!0},{key:"error-icon",fn:function(){return[e._t("error-icon")]},proxy:!0},{key:"remove-icon",fn:function(){return[e._t("remove-icon")]},proxy:!0}],null,!0),model:{value:e.input,callback:function(i){e.input=i},expression:"input"}},"BaseChipsInputField",e.chipsFieldInputProps,!1),e.$listeners))],1)},d=[],c=a.default(p,u,d,!1,null,"90d3c286",null,null);const f=c.exports;exports.default=f;
//# sourceMappingURL=BaseChipsInput.cjs.js.map
