{"version":3,"file":"BaseMenuList.es.js","sources":["../../../src/components/BaseMenuList/BaseMenuList.vue"],"sourcesContent":["<template>\n  <draggable\n    ref=\"draggable\"\n    :value=\"list\"\n    :sort=\"false\"\n    :disabled=\"!isDraggable || selectActive\"\n    :group=\"{ name: dragName, pull: 'clone', put: false }\"\n    :set-data=\"modifyDragItem\"\n    :force-fallback=\"!dragAndDropCapable\"\n    :fallback-on-body=\"!dragAndDropCapable\"\n    tag=\"ul\"\n    class=\"base-menu-list\"\n    @choose=\"getDragImage\"\n    @start=\"dragStart\"\n    @end=\"dragEnd\">\n    <li\n      v-for=\"(item, index) in list\"\n      :key=\"item.id || item.title\"\n      class=\"base-menu-list__list-entry\">\n      <base-menu-entry\n        ref=\"menuEntry\"\n        :entry-id=\"item.id\"\n        :title=\"item.title\"\n        :is-active=\"entryProps[index].active\"\n        :is-selected=\"entryProps[index].selected\"\n        :is-disabled=\"item.disabled\"\n        :icon=\"item.icon\"\n        :description=\"item.description\"\n        :is-selectable=\"true\"\n        :select-active=\"selectActive\"\n        @clicked=\"activateItem(index)\"\n        @selected=\"selectItem(index, $event)\">\n        <template #text-content>\n          <!-- @slot use this slot to individualize the displayed text per\n            menu entry.\n            @binding { Object } item - the complete entry provided by list -->\n          <slot\n            name=\"entry-text-content\"\n            :item=\"item\" />\n        </template>\n        <template #right-side-elements=\"{ isSelected }\">\n          <!-- @slot use this slot to add elements to the right side of an entry. This slot content\n            will be rendered in place of thumbnails and select checkbox so it will effectively\n            disable the display of selection elements and if select mode is desired, custom elements\n            should be provided\n             @binding { Object } item - the complete entry provided by list\n             @binding { boolean } is-selected - was item selected -->\n          <slot\n            name=\"entry-right-side-elements\"\n            :is-selected=\"isSelected\"\n            :item=\"item\" />\n        </template>\n        <template\n          #thumbnails>\n          <!-- @slot Use this scoped slot to supply a list of thumbnails (i.e. [BaseIcon](BaseIcon)) for `item`, where `item` is one list element. See also the example below.-->\n          <slot\n            name=\"thumbnails\"\n            :item=\"item\" />\n        </template>\n      </base-menu-entry>\n    </li>\n  </draggable>\n</template>\n\n<script>\nimport Draggable from 'vuedraggable';\nimport BaseMenuEntry from '../BaseMenuEntry/BaseMenuEntry';\n\n/**\n * Base Component for SideBar Menu Entries\n *   (this component is currently not ssr-capable)\n */\n\nexport default {\n  name: 'BaseMenuList',\n  components: {\n    BaseMenuEntry,\n    Draggable,\n  },\n  props: {\n    /**\n     * define if entries are selectable -> d.h. the selectboxes are showing\n     */\n    selectActive: {\n      type: Boolean,\n      default: false,\n    },\n    /**\n     * list of menu entries - array of objects\n     *   Entry properties that can be displayed:\n     *\n     *     *required*:\n     *      **id** `string` - give every item an unique id\n     *\n     *     *optional*:\n     *      **title** `string` - main text line in the list item\n     *      **description** `string` - second text line in the list item\n     *      **active** `boolean` - steer from outside if item should be displayed active (with left\n     *        side color border)\n     *      **selected** `boolean` - steer from outside if entry select box should be checked\n     *      **disabled** `boolean` - steer from outside if entry select box should be disabled\n     *      **icon** `string` - a valid [BaseIcon](BaseIcon) icon name\n     *\n     *      Also see [BaseMenuEntry](BaseMenuEntry) component for more information on\n     *        the mentioned properties.\n     */\n    list: {\n      type: Array,\n      default: () => [],\n      validator: val => val.every(item => Object.keys(item).includes('id')),\n    },\n    /**\n     * index of the entry that should currently be active\n     * TODO: check if it would be better to use id here!\n     */\n    activeEntry: {\n      type: Number,\n      default: -1,\n    },\n    /**\n     * provide a list of entries that should appear selected\n     */\n    selectedList: {\n      type: Array,\n      default: () => [],\n    },\n    /**\n     * specify the group name for the drag receiver\n     */\n    dragName: {\n      type: String,\n      default: 'menuEntry',\n    },\n  },\n  data() {\n    return {\n      // have internally necessary props in separate array to prevent issues with\n      // outside store mutations\n      entryProps: [],\n      dragging: false,\n      dragAndDropCapable: false,\n      isDraggable: true,\n      resizeTimeout: null,\n      /**\n       * chrome can not deal with delay if drag image is cloned from dom on setData directly\n       * so image needs to be set previously and stored in variable\n       * @type {?SVGElement}\n       */\n      dragImg: null,\n    };\n  },\n  watch: {\n    list() {\n      this.setInternalVar();\n    },\n    activeEntry(val) {\n      this.entryProps.map(item => this.$set(item, 'active', false));\n      if (val >= 0 && this.entryProps[val]) {\n        this.$set(this.entryProps[val], 'active', true);\n      }\n    },\n    selectActive(val) {\n      if (!val) {\n        this.entryProps.forEach(entry => this.$set(entry, 'selected', false));\n      } else {\n        this.setInternalVar();\n      }\n    },\n    selectedList() {\n      this.setInternalVar();\n    },\n  },\n  created() {\n    this.setInternalVar();\n  },\n  mounted() {\n    this.isDraggable = !this.isMobile();\n    this.dragAndDropCapable = ('DragEvent' in window);\n\n    window.addEventListener('resize', () => {\n      clearTimeout(this.resizeTimeout);\n      this.resizeTimeout = setTimeout(() => {\n        this.isDraggable = !this.isMobile();\n      }, 250);\n    });\n\n    // Set _sortable.nativeDraggable directly due\n    // prop force-fallback in vue-draggable is not propagated to sortablejs if updated\n    // eslint-disable-next-line\n    if (typeof this.$refs.draggable._sortable.nativeDraggable !== 'undefined') {\n      // eslint-disable-next-line\n      this.$refs.draggable._sortable.nativeDraggable = this.dragAndDropCapable;\n    } else {\n      // eslint-disable-next-line\n      console.warn('The option \"nativeDraggable\" in sortableJS is missing. '\n        + 'Please check for changes https://github.com/SortableJS/sortablejs.');\n    }\n  },\n  methods: {\n    // this function is called when a menu entry is clicked (when checkboxes not active)\n    activateItem(index) {\n      /**\n       * event emitted when a menu entry is clicked\n       *\n       * @event clicked\n       * @param { String } - the index of the respective entry\n       */\n      this.$emit('clicked', index);\n    },\n    selectItem(index, selected) {\n      this.$set(this.entryProps[index], 'selected', selected);\n      /**\n       * event emitted when entry is clicked and select is active\n       *\n       * @event selected\n       * @type { Object }\n       * @property {string} index - the index of the selected item\n       * @property {boolean} selected - was items selected\n       */\n      this.$emit('selected', { index, selected });\n    },\n    setInternalVar() {\n      this.entryProps = this.list.map(entry => ({\n        ...{\n          selected: entry.selected || this.selectedList.includes(entry.id),\n          active: entry.active || false,\n          error: entry.error || false,\n        },\n      }));\n      if (this.entryProps.length && this.activeEntry >= 0) {\n        this.$set(this.entryProps[this.activeEntry], 'active', true);\n      }\n    },\n    /**\n     * get the relevant icon image from the dom and save it in a variable\n     * (Chrome could not deal with setting it in modifyDragItem directly)\n     * @param {CustomEvent} event\n     */\n    getDragImage(event) {\n      // get the relevant svg element from the base menu entry by class name\n      // (necessary to use class name so thumbnail sgvs are not used if no icon is provided in list)\n      const entryIcon = event.item.getElementsByClassName('base-menu-entry-icon')[0];\n      // check if icon was set\n      if (entryIcon) {\n        // get the size to be able to set it to the drag image as well\n        const size = `${(entryIcon.clientHeight * 2)}px`;\n\n        // clone the svg used in this entry\n        const pic = entryIcon.cloneNode(true);\n        pic.id = 'drag-icon';\n        pic.style.height = size;\n        pic.style.maxHeight = size;\n        pic.style.width = size;\n        pic.style.backgroundColor = 'white';\n        pic.style.position = 'absolute';\n        pic.style.top = '-99999px';\n        pic.style.left = '-99999px';\n        // store it in the variable\n        this.dragImg = pic;\n      } else {\n        this.dragImg = null;\n      }\n    },\n    dragStart() {\n      this.dragging = true;\n    },\n    dragEnd() {\n      this.dragging = false;\n      // remove drag item from the body again if necessary after drag ended\n      const elem = document.getElementById('drag-icon');\n      if (elem) {\n        elem.parentNode.removeChild(elem);\n      }\n    },\n    modifyDragItem(dataTransfer) {\n      // check if drag image was set (not the case if no icon was provided in list items)\n      if (this.dragImg) {\n        // add the element retrieved in choose event (getDragImage()) to the dom\n        document.body.appendChild(this.dragImg);\n        // Edge does not support setDragImage\n        if (typeof DataTransfer.prototype.setDragImage === 'function') {\n          dataTransfer.setDragImage(this.dragImg, 0, 0);\n        }\n      }\n      dataTransfer.setData('draggable', '');\n    },\n    isMobile() {\n      return window.innerWidth < 640;\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n  @import \"../../styles/variables\";\n\n  .base-menu-list {\n    position: relative;\n\n    .base-menu-list__list-entry {\n      &:not(:last-of-type) {\n        border-bottom: $separation-line;\n      }\n    }\n  }\n</style>\n"],"names":["_sfc_main","BaseMenuEntry","Draggable","val","item","entry","index","selected","event","entryIcon","size","pic","elem","dataTransfer"],"mappings":"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"}